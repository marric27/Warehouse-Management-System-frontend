<form [formGroup]="form" (ngSubmit)="submit()">
  <mat-form-field appearance="fill">
    <mat-label>Pick List</mat-label>
    <mat-select formControlName="pickListCode" required>
      @for (p of picklists; track $index) {
      <mat-option [value]="p.code">
        {{ p.code }}
      </mat-option>
      }
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>PickList Item</mat-label>
    <mat-select formControlName="pickListItemCode">
      @for(item of picklistItems; track $index) {
      <mat-option [value]="item.code"> {{ item.code }} - {{ item.productCode }} </mat-option>
      }
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="fill">
    <mat-label>errorReason</mat-label>
    <input matInput type="text" formControlName="errorReason" required />
  </mat-form-field>
  <mat-form-field appearance="fill">
    <mat-label>user</mat-label>
    <input matInput type="text" formControlName="user" required />
  </mat-form-field>

  <div formArrayName="stockUnitQuantities">
    @for(item of stockUnitQuantities.controls; track $index) {
    <div [formGroupName]="$index" class="line-row">
      <mat-form-field appearance="fill">
        <mat-label>Stock Unit</mat-label>
        <mat-select formControlName="suId" required>
          @for (stockUnit of stockUnits; track $index) {
          <mat-option [value]="stockUnit.code">
            {{ stockUnit.code }}
          </mat-option>
          }
        </mat-select>
      </mat-form-field>

      <mat-form-field>
        <mat-label>Quantity</mat-label>
        <input matInput type="number" formControlName="quantity" />
      </mat-form-field>

      <button mat-icon-button color="warn" type="button" (click)="removeLine($index)">âœ•</button>
    </div>
    }
  </div>
  <button mat-raised-button color="primary" type="button" (click)="addLine()">Add Line</button>

  <button mat-raised-button color="primary" type="submit" [disabled]="form.invalid">Submit</button>
</form>
